(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function t(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(n){if(n.ep)return;n.ep=!0;const r=t(n);fetch(n.href,r)}})();function w(s){const{clientWidth:e,clientHeight:t}=s;return{w:e,h:t}}function K(){return window.devicePixelRatio||1}function V(s){const e=K();s.setTransform(1,0,0,1,0,0),s.scale(e,e)}function ne(s){const e=K(),{w:t,h:i}=w(s);return s.width=Math.round(t*e),s.height=Math.round(i*e),{w:t,h:i,dpr:e}}class se{constructor(){this.listeners=new Set,this.watchedCanvases=new Map,this.mediaQuery=null,this.boundTrigger=this.trigger.bind(this),this.dprCallback=null,this.metrics={w:0,h:0,dpr:1}}subscribe(e){this.listeners.add(e),e(),this.listeners.size===1&&this.attachWindowListeners()}unsubscribe(e){this.listeners.delete(e),this.listeners.size===0&&this.detachWindowListeners()}watchCanvas(e){const t=()=>{const i=ne(e);this.metrics=i};this.watchedCanvases.set(e,t),this.subscribe(t)}unwatchCanvas(e){const t=this.watchedCanvases.get(e);t&&(this.unsubscribe(t),this.watchedCanvases.delete(e))}trigger(){this.listeners.forEach(e=>e())}attachWindowListeners(){typeof window<"u"&&(window.addEventListener("resize",this.boundTrigger),this.addDprListener())}detachWindowListeners(){var e;typeof window<"u"&&window.removeEventListener("resize",this.boundTrigger),this.dprCallback&&((e=this.mediaQuery)==null||e.removeEventListener("change",this.dprCallback)),this.mediaQuery=null,this.dprCallback=null}addDprListener(){var e;typeof window>"u"||typeof window.matchMedia>"u"||(this.dprCallback&&((e=this.mediaQuery)==null||e.removeEventListener("change",this.dprCallback)),this.mediaQuery=matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`),this.dprCallback=()=>{this.boundTrigger(),this.addDprListener()},this.mediaQuery.addEventListener("change",this.dprCallback,{once:!0}))}get cssWidth(){return this.metrics.w}get cssHeight(){return this.metrics.h}get dpr(){return this.metrics.dpr}}const y=new se,re=["#FFD1DC","#B5EAD7","#C7CEEA","#FFDAC1","#E2F0CB"],oe={colors:re},ae=1.2,ce=.5,S=oe.colors,J=S[2],Z="#222",le="Noto Sans JP, sans-serif",de=Z,he=.7,ue=.4,fe=15,ge=.85,H=.15,me=.6,j=4,v=class v{constructor(e,t=v.bootLevel){this.scope=e,this.level=t}out(e,...t){}debug(...e){this.out("debug",...e)}info(...e){this.out("info",...e)}warn(...e){this.out("warn",...e)}error(...e){this.out("error",...e)}};v.bootLevel=(()=>{if(typeof globalThis>"u"||!("localStorage"in globalThis))return"info";const e=localStorage.getItem("logLevel");return e&&["debug","info","warn","error","off"].includes(e)?e:"info"})(),v.isDebug=v.bootLevel==="debug",v.levelOrder={debug:0,info:1,warn:2,error:3,off:4};let u=v;function pe(){return{setLevel(s){localStorage.setItem("logLevel",s),location.reload()}}}window.logger=pe();const be=new u("SM");class we{constructor(){this.states=new Map}add(e,t){return this.states.set(e,t),this}change(e){var t,i,n,r;be.info("→ change",{from:this.currentName,to:e}),(i=(t=this.current)==null?void 0:t.exit)==null||i.call(t),this.current=this.states.get(e),this.currentName=e,(r=(n=this.current)==null?void 0:n.enter)==null||r.call(n)}update(e){var t,i;(i=(t=this.current)==null?void 0:t.update)==null||i.call(t,e)}get currentStateName(){return this.currentName}}function ve(s,e){const t=()=>s.change("play");function i(){V(e);const{w:n,h:r}=w(e.canvas);e.fillStyle=J,e.fillRect(0,0,n,r),e.fillStyle=Z,e.textAlign="center",e.font="32px sans-serif",e.fillText("Tap to Start",n/2,r/2)}return{enter(){y.subscribe(i),e.canvas.addEventListener("pointerdown",t)},update(){i()},exit(){y.unsubscribe(i),e.canvas.removeEventListener("pointerdown",t)}}}function ye(){if(typeof navigator>"u")return!1;const s=typeof navigator>"u"?"":navigator.userAgent;return/iPad|iPhone|iPod/.test(s)&&!(typeof window<"u"&&window.MSStream)}function Ae(){if(typeof navigator>"u")return!1;const s=typeof navigator>"u"?"":navigator.userAgent;return/iPad/.test(s)||typeof navigator<"u"&&navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1}function F(){if(typeof navigator>"u")return!1;if(ye()||Ae())return!0;const s=typeof navigator>"u"?"":navigator.userAgent;return!!(/iPad|iPhone|iPod/.test(s)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>0)}const p=new u("Audio");class Pe{constructor(){this.bank=new Map}async ensureContext(){const e=()=>{const t=globalThis,i=t.AudioContext??t.webkitAudioContext;if(!i)throw new Error("Web Audio API not supported");const n=new i;return p.info(`Created new AudioContext: ${n.state}`),n};if((!this.ctx||this.ctx.state==="closed")&&(this.ctx=e()),this.ctx.state==="suspended"||this.ctx.state==="interrupted"){p.info(`Attempting resume() from ${this.ctx.state}`);try{await this.ctx.resume()}catch(t){p.warn("resume() threw",t)}}if(this.ctx.state!=="running"){p.warn(`AudioContext stuck in '${this.ctx.state}', recreating…`);try{await this.ctx.close()}catch{}this.ctx=e(),await this.ctx.resume()}return this.ctx}async fetch(e){if(this.bank.has(e))return this.bank.get(e);try{const t=await(await fetch(e)).arrayBuffer(),n=await(await this.ensureContext()).decodeAudioData(t);return this.bank.set(e,n),n}catch(t){throw p.error(`decodeAudioData failed for ${e}`,t),t}}async play(e){const t=await this.ensureContext(),i=t.createBufferSource();i.buffer=e,i.connect(t.destination),i.start(),i.onended=()=>i.disconnect()}async resume(){try{const e=await this.ensureContext();if(F()){p.info("iOS/iPadOS detected, playing silent buffer to unlock audio");const t=e.sampleRate||44100,i=e.createBuffer(2,t*.5,t);for(let o=0;o<2;o++){const l=i.getChannelData(o);for(let c=0;c<l.length;c++)l[c]=0}const n=F()?.5:.1,r=e.createGain();r.gain.value=.001;const a=e.createBufferSource();a.buffer=i,a.connect(r),r.connect(e.destination),a.start(0),a.stop(e.currentTime+n),a.onended=()=>{a.disconnect(),r.disconnect()},p.info(`Silent buffer played (duration: ${n}s)`)}return e}catch(e){throw p.error("Resume failed",e),e}}}const C=new u("Storage");class Se{constructor(){this.isNative=!1,this.storage=this.detectStorage()}detectStorage(){if(typeof window<"u"&&typeof localStorage=="object")try{const e="__storage_test__";return localStorage.setItem(e,e),localStorage.removeItem(e),C.debug("Using native localStorage"),this.isNative=!0,localStorage}catch(e){C.warn("localStorage detected but unavailable (Safari private mode?), using memory storage",e)}else C.info("No localStorage available (Node/test environment), using memory storage");return new Map}get(e){if(this.isNative)return this.storage.getItem(e);const t=this.storage;return t.has(e)?t.get(e):null}set(e,t){this.isNative?this.storage.setItem(e,t):this.storage.set(e,t)}remove(e){this.isNative?this.storage.removeItem(e):this.storage.delete(e)}clear(){this.isNative?this.storage.clear():this.storage.clear()}}const U=new Se,ke="modulepreload",Ee=function(s){return"/kana-pop/"+s},W={},X=function(e,t,i){let n=Promise.resolve();if(t&&t.length>0){let a=function(c){return Promise.all(c.map(h=>Promise.resolve(h).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));n=a(t.map(c=>{if(c=Ee(c),c in W)return;W[c]=!0;const h=c.endsWith(".css"),f=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${f}`))return;const m=document.createElement("link");if(m.rel=h?"stylesheet":ke,h||(m.as="script"),m.crossOrigin="",m.href=c,l&&m.setAttribute("nonce",l),document.head.appendChild(m),h)return new Promise((te,ie)=>{m.addEventListener("load",te),m.addEventListener("error",()=>ie(new Error(`Unable to preload CSS for ${c}`)))})}))}function r(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return n.then(a=>{for(const o of a||[])o.status==="rejected"&&r(o.reason);return e().catch(r)})},b=class b{static async manifest(){if(!this.manifestPromise){if(!b.loadManifest)throw new Error("Manifest loader not found. Check glob pattern and file existence.");this.manifestPromise=b.loadManifest()}return this.manifestPromise}static async language(e){const t=`../data/lang/${e}.json`,i=b.langFiles[t];if(!i)throw new Error(`No language data file for '${e}'`);return i()}};b.manifestPromise=null,b.langFiles=Object.assign({"../data/lang/ja.json":()=>X(()=>import("./ja-DEJkL8aw.js"),[]).then(e=>e.default)}),b.loadManifest=Object.assign({"../data/lang/index.json":()=>X(()=>import("./index-BJLXKDTG.js"),[]).then(e=>e.default)})["../data/lang/index.json"];let k=b;const G=new u("Lang");class Le{constructor(){var i;const e=U.get("kanaPop.lang"),t=typeof navigator<"u"?(i=navigator.language)==null?void 0:i.slice(0,2):void 0;this.defaultCode=e||t||"ja",this.lang={code:this.defaultCode,name:"loading…",symbols:[],direction:"ltr"}}async load(e=this.defaultCode){const t=await k.manifest(),i=t.find(a=>a.code===e)??t.find(a=>a.code===this.defaultCode);if(!i)throw new Error("LanguageService: manifest empty");const n=await k.language(i.code);i.direction||G.warn(`'${i.code}' lacks "direction"; defaulting to 'ltr'`);const r=i.direction??"ltr";this.lang={code:i.code,name:i.name,symbols:n.symbols??[],direction:r},this.persistLang(this.lang.code)}get symbols(){return this.lang.symbols}get currentCode(){return this.lang.code}get direction(){return this.lang.direction}randomGlyph(e){const t=Object.values(e.glyphs);return t.length===0?(G.warn(`Symbol with roman='${e.roman}' (category: ${e.category}, lang: ${this.lang.code}) has no glyphs defined. Returning '?' as fallback.`),"?"):t[Math.floor(Math.random()*t.length)]}persistLang(e){U.set("kanaPop.lang",e)}}const g=new Le,d=new u("Sound"),T=class T{constructor(){this.bank=new Pe,this.isGestureArmed=!1,this.ready=new Promise(e=>this.triggerReady=e),typeof document<"u"&&document.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&(d.debug("Page became visible – poking AudioContext"),this.bank.ensureContext().catch(()=>{}))})}async armFirstGesture(e=window){if(this.isGestureArmed)return;this.isGestureArmed=!0,d.info("First gesture handler armed");const t=F(),i=[],n=(o,l)=>{o.addEventListener(l,a,{passive:!0}),i.push({target:o,type:l})},r=()=>{d.info("Trimming audio unlock listeners (keeping one for re-unlock)");let o=!1;i.forEach(({target:l,type:c})=>{if(!o&&l===window&&c==="pointerdown"){o=!0;return}l.removeEventListener(c,a)})},a=async()=>{d.info("User gesture detected, unlocking audio");let o=!1;try{await this.bank.resume(),d.info("Audio context unlocked successfully"),o=!0}catch(l){d.warn("AudioContext unlock failed, trying HTML Audio fallback",l);try{const c=new Audio(T.SILENT);c.autoplay=!0,c.muted=!1,c.volume=.001,c.setAttribute("playsinline",""),d.info("Playing fallback HTML audio");const h=c.play();if(h instanceof Promise){await h,d.info("Fallback audio played successfully");try{await this.bank.resume(),d.info("Audio context unlocked after HTML audio fallback"),o=!0}catch(f){d.warn("Audio context still locked after HTML audio fallback",f)}}else d.warn("Fallback audio play() returned no promise")}catch(c){d.error("All audio unlock attempts failed",c)}}this.triggerReady(),o?r():d.warn("Audio still locked – listeners stay armed for another try")};d.info("Registering audio unlock gesture handlers"),n(e,"pointerdown"),n(e,"touchstart"),n(e,"click"),t&&(d.info("Adding extra handlers for iOS/iPadOS"),n(document.body,"pointerdown"),n(document.body,"touchstart"),n(document.body,"click"),n(document,"pointerdown"),n(document,"touchstart"),n(document,"click"),n(window,"pointerdown"),n(window,"touchstart"),n(window,"click"))}async play(e){if(await this.ready,e.endsWith("fallback.mp3"))return;const t=q(`/kana-pop/audio/${e}`);try{const i=await this.bank.fetch(t);await this.bank.play(i)}catch(i){d.warn(`Web Audio playback failed for ${t}, using HTMLAudioElement fallback`,i),new Audio(t).play().catch(n=>{d.error(`HTMLAudioElement fallback also failed for ${t}`,n)})}}playRoman(e){var i;const t=(i=g.symbols.find(n=>n.roman===e))==null?void 0:i.audio;t&&this.play(`${g.currentCode}/${t}`)}async preloadAll(e){await this.ready,d.info(`Preloading ${e.length} audio files`),await Promise.all(e.map(t=>{if(t.endsWith("fallback.mp3"))return Promise.resolve();const i=q(`/kana-pop/audio/${t}`);return this.bank.fetch(i).catch(n=>{d.warn(`Failed to preload audio: ${t}`,n)})})),d.info("Audio preloading complete")}};T.SILENT="data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEAIlYAACJWAAABAAgAZGF0YQAAAAA=";let R=T;const D=new R;function q(s){return s.startsWith("data:")?s:`${s}?v=mbj7njdi`}class Te{constructor(){this.enabled=!1,!(typeof window<"u"&&window.matchMedia("(prefers-reduced-motion: reduce)").matches)&&typeof navigator<"u"&&typeof navigator.vibrate=="function"&&(this.enabled=!0)}vibrate(e=15){var t;this.enabled&&((t=navigator.vibrate)==null||t.call(navigator,e))}}const Ce=new Te,z=new u("Bubble");class Me{constructor(e,t,i,n,r,a){this.x=e,this.y=t,this.color=i,this.glyph=n,this.romaji=r,this.active=!0,this.speed=.2,this.scale=1,this.flashTimer=0,this.showingRomaji=!1,this.lastSpoken=-1/0,this.r=a,z.debug("spawn",{x:this.x.toFixed(2),color:i,glyph:this.glyph})}handleClick(e){e-this.lastSpoken<ue||(this.lastSpoken=e,this.showingRomaji=!this.showingRomaji,D.playRoman(this.romaji),Ce.vibrate(fe),this.scale=ge,this.flashTimer=H,z.debug("toggle",{romaji:this.showingRomaji}))}step(e){this.y-=this.speed*e,this.y<-.05&&(this.active=!1),this.scale!==1&&(this.scale+=(1-this.scale)*10*e,Math.abs(this.scale-1)<.001&&(this.scale=1)),this.flashTimer>0&&(this.flashTimer-=e,this.flashTimer<0&&(this.flashTimer=0))}contains(e,t,i,n){if(!this.active)return!1;const r=this.x*i,a=this.y*n,o=e-r,l=t-a,c=o*o+l*l,h=this.r*this.scale;return c<=h*h}get flashAlpha(){return this.flashTimer>0?this.flashTimer/H:0}}function Y(s,e){return Math.min(s,e)*.06}const Fe=new u("BubbleMgr"),ee=s=>Math.floor(Math.random()*s),Re=()=>S.length?S[ee(S.length)]??"#FFFFFF":"#FFFFFF";class Oe{constructor(e){this.canvas=e,this.bubbles=[],this.spawnTimer=0,this.rPx=0;const{w:t,h:i}=w(e);this.rPx=Y(t,i)}get entities(){return this.bubbles}update(e){this.spawnTimer-=e,this.spawnTimer<=0&&(this.spawn(),this.spawnTimer=ae),this.bubbles.forEach(t=>t.step(e)),this.bubbles.some(t=>!t.active)&&(this.bubbles=this.bubbles.filter(t=>t.active))}handleResize(){const{w:e,h:t}=w(this.canvas);this.rPx=Y(e,t),this.bubbles.forEach(i=>i.r=this.rPx)}hitTest(e,t){const{w:i,h:n}=w(this.canvas);for(let r=this.bubbles.length-1;r>=0;r--){const a=this.bubbles[r];if(a&&a.contains(e,t,i,n))return a}}clear(){this.bubbles=[]}spawn(){var o;if(!((o=g.symbols)!=null&&o.length))return;const e=g.symbols[ee(g.symbols.length)],t=g.randomGlyph(e),{w:i}=w(this.canvas),n=this.rPx/i,r=n+Math.random()*(1-2*n),a=1+n;this.bubbles.push(new Me(r,a,Re(),t,e.roman,this.rPx)),Fe.debug("spawn",{total:this.bubbles.length,roman:e.roman})}}const $e=new u("Pointer");class xe{constructor(e,t){this.canvas=e,this.bubbles=t,this.bound=this.onDown.bind(this)}attach(){this.canvas.addEventListener("pointerdown",this.bound)}detach(){this.canvas.removeEventListener("pointerdown",this.bound)}onDown(e){var a,o;const t=this.canvas.getBoundingClientRect(),i="clientX"in e?e.clientX:((a=e.touches[0])==null?void 0:a.clientX)??0,n="clientY"in e?e.clientY:((o=e.touches[0])==null?void 0:o.clientY)??0,r=this.bubbles.hitTest(i-t.left,n-t.top);r&&(r.handleClick(performance.now()/1e3),$e.debug("hit",{roman:r.romaji}))}}class O{constructor(){this.active=!1,this.listener=e=>{var n;const t=(e.gamma??0)/45,i=(e.beta??0)/45;(n=this.cb)==null||n.call(this,{x:Q(t),y:Q(i)})}}async start(e){if(this.active)return;this.cb=e;const t=window.DeviceOrientationEvent;if(t&&typeof t.requestPermission=="function")try{if(await t.requestPermission()!=="granted"){console.warn("DeviceOrientationEvent permission denied. Gyro motion will not be available initially from this provider.");return}}catch(i){console.warn("Error requesting DeviceOrientationEvent permission or permission denied:",i);return}window.addEventListener("deviceorientation",this.listener,!0),this.active=!0}stop(){this.active&&(window.removeEventListener("deviceorientation",this.listener,!0),this.active=!1,this.cb=void 0)}isActive(){return this.active}}class ${constructor(){this.raf=0,this.t=0}start(e){this.cb=e;const t=()=>{var i;this.t+=.001,this.t>1&&(this.t-=1),(i=this.cb)==null||i.call(this,{x:0,y:Math.sin(this.t*Math.PI*2)}),this.raf=requestAnimationFrame(t)};this.raf=requestAnimationFrame(t)}stop(){this.raf&&(cancelAnimationFrame(this.raf),this.raf=0),this.cb=void 0}}function Be(){return"DeviceOrientationEvent"in window?new O:new $}const Q=s=>Math.max(-1,Math.min(1,s));class Ie{constructor(){this.logger=new u("BackgroundRenderer"),this.activeProviderFailed=!1,this.offset={x:0,y:0},this.MAX_SHIFT=30,this.logger.debug("BackgroundRenderer instantiated"),this.motionProvider=Be(),this.startMotionTracking()}async startMotionTracking(){const e=this.motionProvider;try{if(await e.start(t=>this.offset=t),e instanceof O)if(e.isActive()){this.logger.info("Gyro motion provider started successfully.");return}else this.logger.warn("GyroProvider did not become active (e.g., permission denied or no sensor). Attempting fallback."),this.activeProviderFailed=!0;else if(e instanceof $){this.logger.info("DummyScrollProvider started (was initial choice).");return}}catch(t){this.logger.error("Error starting initial motion provider:",t),this.activeProviderFailed=!0}this.activeProviderFailed&&e instanceof O&&(this.logger.info("Falling back to DummyScrollProvider for background motion."),e&&e.stop(),this.motionProvider=new $,this.motionProvider.start(t=>this.offset=t),this.logger.info("DummyScrollProvider started as fallback."))}update(e){}draw(e){const{w:t,h:i}=w(e.canvas);e.fillStyle=J,e.fillRect(0,0,t,i),e.save(),e.translate(this.offset.x*this.MAX_SHIFT,this.offset.y*this.MAX_SHIFT);const n=80;e.fillStyle="rgba(255,255,255,0.12)";const r=-this.MAX_SHIFT-n,a=-this.MAX_SHIFT-n,o=t+this.MAX_SHIFT+n,l=i+this.MAX_SHIFT+n;for(let c=a;c<l;c+=n)for(let h=r;h<o;h+=n)e.fillRect(h,c,2,2);e.restore()}dispose(){this.motionProvider&&(this.motionProvider.stop(),this.logger.debug("Motion provider stopped."))}}class De{render(e,t,i,n){const r=t.x*i,a=t.y*n,o=t.r*t.scale;e.save(),e.globalAlpha=ce,e.fillStyle=t.color,e.beginPath(),e.arc(r,a,o,0,Math.PI*2),e.fill(),e.restore();const l=t.showingRomaji?t.romaji:t.glyph,c=t.showingRomaji?.45:he;e.fillStyle=de,e.textAlign="center",e.textBaseline="middle",e.font=`${Math.round(o*c)}px ${le}`,e.fillText(l,r,a),t.flashAlpha>0&&(e.save(),e.globalAlpha=t.flashAlpha*me,e.lineWidth=j,e.strokeStyle="#ffffff",e.beginPath(),e.arc(r,a,o+j*.5,0,Math.PI*2),e.stroke(),e.restore())}}const A=new u("Play");let P=0,M=0;function _e(s){const e=new Oe(s.canvas),t=new De,i=new Ie;let n=!1;const r=()=>e.handleResize(),a=new xe(s.canvas,e);return{update(o){if(!n)return;V(s);const{w:l,h:c}=w(s.canvas),h=o;if(o=Math.min(h,.1),P+=h,M++,P>=1){const f=Math.round(M/P);u.isDebug&&A.debug("fps",f),P=0,M=0}e.update(o),i.update(o),i.draw(s),e.entities.forEach(f=>t.render(s,f,l,c))},async enter(){A.info("Play screen entered"),await g.load("ja"),D.preloadAll(g.symbols.map(o=>`${g.currentCode}/${o.audio}`)).catch(o=>A.warn("audio preload",o)),n=!0,y.subscribe(r),r(),a.attach()},exit(){A.info("Play screen exited"),y.unsubscribe(r),a.detach(),e.clear(),i.dispose()}}}const _=document.querySelector("#game");if(!_)throw new Error("#game canvas not found");const x=_.getContext("2d");if(!x)throw new Error("2-D context not available");function B(){document.documentElement.style.setProperty("--app-height",`${window.innerHeight}px`)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",B,{once:!0}):B();window.addEventListener("resize",B);D.armFirstGesture(window);y.watchCanvas(_);const E=new we;E.add("menu",ve(E,x)).add("play",_e(x));E.change("menu");let L=0,I=performance.now();function N(s){const e=(s-I)/1e3;I=s,E.update(e),L=requestAnimationFrame(N)}L=requestAnimationFrame(N);document.addEventListener("visibilitychange",()=>{document.hidden?cancelAnimationFrame(L):(I=performance.now(),L=requestAnimationFrame(N))});
